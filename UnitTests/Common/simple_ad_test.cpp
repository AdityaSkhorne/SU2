/*!
 * \file simple_ad_test.cpp
 * \brief Tests the algorithmic differentiation in SU2. Aside from testing
 *        basic functionality, this also serves as a regression test
 *        to make sure that AD works within unit testing.
 * \author C. Pederson
 * \version 7.5.1 "Blackbird"
 *
 * SU2 Project Website: https://su2code.github.io
 *
 * The SU2 Project is maintained by the SU2 Foundation
 * (http://su2foundation.org)
 *
 * Copyright 2012-2023, SU2 Contributors (cf. AUTHORS.md)
 *
 * SU2 is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * SU2 is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with SU2. If not, see <http://www.gnu.org/licenses/>.
 */

#include "catch.hpp"
#include <vector>
#include <string>
#include <iostream>
#include "../../Common/include/basic_types/datatype_structure.hpp"
#define MLP_CUSTOM_TYPE su2double
#define USE_MLPCPP

#include "../../subprojects/MLPCpp/include/CLookUp_ANN.hpp"
#include "../../Common/include/containers/CLookUpTable.hpp"
su2double func(const su2double& x) { return x * x * x; }

void GetManifoldDerivatives(su2double pv, su2double enth, su2double mixfrac, su2double *dTdpv, su2double *dTdenth, su2double *dTdmixfrac, std::vector<su2double*> &output_refs, MLPToolbox::CLookUp_ANN &input_MLP, MLPToolbox::CIOMap &iomap_test) {
  std::vector<su2double> MLP_inputs;
  int idx_pv{-1}, idx_enth{-1}, idx_mixfrac{-1}, idx_T{-1}, idx_molarweight{-1};
  MLP_inputs.resize(3);
  MLP_inputs[0] = pv;
  MLP_inputs[1] = enth;
  MLP_inputs[2] = mixfrac;

  AD::StartRecording();
  AD::RegisterInput(pv);
  AD::SetIndex(idx_pv, pv);
  AD::RegisterInput(enth);
  AD::SetIndex(idx_enth, enth);
  AD::RegisterInput(mixfrac);
  AD::SetIndex(idx_mixfrac, mixfrac);

  MLP_inputs[0] = pv;
  MLP_inputs[1] =	enth;
  MLP_inputs[2] = mixfrac;

  input_MLP.PredictANN(&iomap_test, MLP_inputs, output_refs);

  su2double T_output = *output_refs[0];
  AD::RegisterOutput(T_output);
  AD::StopRecording();
  SU2_TYPE::SetDerivative(T_output, 1.0);
  AD::ComputeAdjoint();

  *dTdpv= AD::GetDerivative(idx_pv);
  *dTdenth= AD::GetDerivative(idx_enth);
  *dTdmixfrac= AD::GetDerivative(idx_mixfrac);
}
/*---
 * This test case is based off of Tutorial 2 in the CoDiPack
 * documentation:
 *    https://www.scicomp.uni-kl.de/codi/dc/d7e/Tutorial2.html
 * SU2 wrapper functions have been substituted for the CoDiPack calls.
 * ---*/
TEST_CASE("Simple AD Test", "[AD tests]") {
  su2double x = 4.0;

  AD::StartRecording();
  AD::RegisterInput(x);

  su2double y = func(x);

  AD::RegisterOutput(y);
  AD::StopRecording();
  SU2_TYPE::SetDerivative(y, 1.0);
  AD::ComputeAdjoint();

  CHECK(SU2_TYPE::GetValue(y) == Approx(64));
  CHECK(SU2_TYPE::GetDerivative(x) == Approx(48));
}

TEST_CASE("MLPCPP AD Test", "[AD tests]") {
  std::vector<std::string> input_varnames, output_varnames;
  std::vector<su2double> MLP_inputs, MLP_outputs;
  std::vector<su2double*> MLP_output_refs;
  su2double Temperature = 0, mean_molar_weight;
  int idx_pv{-1}, idx_enth{-1}, idx_mixfrac{-1}, idx_T{-1}, idx_molarweight{-1};

  input_varnames.resize(3);
  MLP_inputs.resize(3);
  input_varnames[0] = "ProgressVariable";
  input_varnames[1] = "EnthalpyTot";
  input_varnames[2] = "MixtureFraction";

  output_varnames.resize(2);
  MLP_outputs.resize(2);
  MLP_output_refs.resize(2);
  output_varnames[0] = "Temperature";
  MLP_output_refs[0] = &Temperature;
  output_varnames[1] = "mean_molar_weight";
  MLP_output_refs[1] = &mean_molar_weight;

  size_t n_MLPs = 1;
  std::string MLP_filenames[] = {"/home/ecbunschoten/RACE/Adjoint/MLP/MLP_TD.mlp"};
  MLPToolbox::CLookUp_ANN lookup_MLP = MLPToolbox::CLookUp_ANN(n_MLPs, MLP_filenames);
  MLPToolbox::CIOMap iomap = MLPToolbox::CIOMap(input_varnames, output_varnames);

  lookup_MLP.PairVariableswithMLPs(iomap);

  su2double pv = -0.49904325357252965,
            enth = 2226.901776784524,
            mixfrac = 0.01446751783896619;


  // AD::StartRecording();
  // AD::RegisterInput(pv);
  // // AD::SetIndex(idx_pv, pv);
  // // AD::RegisterInput(enth);
  // // AD::SetIndex(idx_enth, enth);
  // // AD::RegisterInput(mixfrac);
  // // AD::SetIndex(idx_mixfrac, mixfrac);

  // //CLookUpTable LUT = CLookUpTable("/home/ecbunschoten/RACE/Table_vs_MLP/LUT/Comparison_Case/LUT_400_03_015.drg", input_varnames[0], input_varnames[1]);


  // MLP_inputs[0] = pv;
  // MLP_inputs[1] =	enth;
  // MLP_inputs[2] = mixfrac;

  // //lookup_MLP.PredictANN(&iomap, MLP_inputs, MLP_output_refs);
  // //LUT.LookUp_XYZ(output_varnames, MLP_output_refs, pv, enth, mixfrac);
  // mean_molar_weight = 0.5*pv + 0.6*enth + 0.4*mixfrac;
  // AD::RegisterOutput(mean_molar_weight);
  // AD::StopRecording();
  // //AD::SetDerivative(idx_pv, 1.0);
  // // SU2_TYPE::SetDerivative(enth, 1.0);
  // // SU2_TYPE::SetDerivative(mixfrac, 1.0);
  // AD::ComputeAdjoint();

  su2double x = 4.0;
  su2double delta = 1e-6;

  std::vector<su2double> mixfrac_test = {0.01442201249,0.01442088187,0.01441975124,0.01441862155,0.01441746578,0.01441623364,0.01441500243,0.01441377122,0.01441248413,0.01441114396,0.01440980285,0.01440846175,0.01440703217,0.01440557279,0.0144041134,0.01440265309,0.01440106612,0.01439947821,0.01439789031,0.01439626794,0.0143945422,0.01439281646,0.01439109072,0.01438928954,0.01438741479,0.01438553911,0.01438366435,0.0143816676,0.01437963173,0.01437759493,0.01437555719,0.01437334809,0.014371139,0.0143689299,0.01436667144,0.01436427515,0.01436187979,0.0143594835,0.01435698476,0.01435438823,0.01435179077,0.01434919424,0.01434643287,0.01434362121,0.01434080955,0.01433799323,0.01433494966,0.0143319061,0.01432886254,0.01432575285,0.01432246063,0.01431916934,0.01431587711,0.01431244798,0.01430889033,0.01430533268,0.01430177502,0.01429799851,0.0142941568,0.0142903151,0.01428646687,0.01428232063,0.01427817438,0.01427402813,0.01426979341,0.01426532306,0.01426085178,0.0142563805,0.01425172854,0.01424691081,0.01424209401,0.01423727628,0.0142321717,0.01422698516,0.0142217977,0.01421659999,0.01421101857,0.01420543808,0.01419985667,0.0141941607,0.01418816205,0.0141821634,0.01417616569,0.01416992396,0.01416348293,0.01415704098,0.01415059995,0.01414377335,0.01413686108,0.01412994973,0.01412299369,0.01411558315,0.01410817262,0.01410076208,0.01409316249,0.01408522297,0.01407728437,0.01406934485,0.01406105421,0.0140525559,0.01404405665,0.01403555833,0.01402652822,0.01401743758,0.01400834788,0.013999152,0.01398943644,0.01397972181,0.01397000626,0.01396000199,0.01394962706,0.01393925212,0.01392887719,0.01391801052,0.01390693989,0.01389587019,0.01388479955,0.01387301274,0.01386121009,0.01384940837,0.01383741386,0.01382484194,0.01381227002,0.01379969809,0.01378670614,0.0137733249,0.01375994366,0.01374656335,0.01373251248,0.0137182828,0.01370405313,0.01368977036,0.01367465127,0.01365953218,0.01364441309,0.0136289876,0.01361293718,0.0135968877,0.01358083729,0.01356420387,0.01354718115,0.01353015844,0.01351313572,0.01349523012,0.01347719133,0.01345915347,0.01344096754,0.01342187077,0.013402774,0.01338367723,0.01336412877,0.01334393024,0.01332373265,0.01330353413,0.01328255795,0.01326121483,0.01323987264,0.01321852952,0.01319605857,0.01317352802,0.01315099839,0.01312819682,0.01310443599,0.01308067609,0.01305691525,0.01303253137,0.01300749835,0.01298246626,0.01295743324,0.01293140277,0.01290505752,0.0128787132,0.01285232604,0.01282462943,0.0127969319,0.01276923437,0.0127411196,0.0127120316,0.01268294454,0.01265385654,0.0126239555,0.01259344257,0.01256292872,0.0125324158,0.0125006754,0.01246870309,0.01243673079,0.01240459271,0.01237113122,0.0123376688,0.01230420731,0.01227016654,0.01223518886,0.01220021117,0.01216523349,0.01212925278,0.01209273562,0.01205621939,0.01201970223,0.01198175084,0.01194367744,0.01190560404,0.01186722983,0.01182758808,0.0117879454,0.01174830273,0.01170793362,0.01166671701,0.0116255004,0.01158428285,0.01154191513,0.01149912365,0.01145633403,0.01141354349,0.01136918645,0.01132483128,0.01128047705,0.01123570278,0.01118980348,0.01114390418,0.01109800488,0.01105128322,0.01100386865,0.01095645316,0.0109090386,0.01086042542,0.01081153564,0.01076264679,0.01071363967,0.01066333055,0.01061302051,0.0105627114,0.01051192451,0.01046026498,0.01040860545,0.01035694499,0.01030449662,0.01025157049,0.01019864436,0.01014571823,0.01009175275,0.01003766246,0.009983572178,0.009929312393,0.00987418741,0.009819061495,0.009763936512,0.009708431549,0.009652430192,0.009596428834,0.009540426545,0.009483940899,0.009427249432,0.009370558895,0.009313868359,0.009256723337,0.009199565277,0.009142408147,0.009085198864,0.009027833119,0.008970466442,0.008913100697,0.008855779655,0.008798504248,0.008741226979,0.008683949709,0.008627009578,0.008570162579,0.008513314649,0.008456510492,0.008400469087,0.008344429545,0.00828838814,0.008232742548,0.008177922107,0.008123100735,0.008068279363,0.008014438674,0.007961268537,0.007908097468,0.0078549264,0.007803529501,0.007752412464,0.007701294031,0.00765050482,0.007601831108,0.007553158794,0.007504485548,0.007456967141,0.007411148865,0.007365329657,0.007319510449,0.00727590872,0.007233376149,0.007190843113,0.007148309611,0.007109172642,0.007070234511,0.007031295449,0.006993193179,0.006958146114,0.006923098117,0.006888050586,0.006855002139,0.006824076176,0.006793149747,0.006762223318,0.006734527647,0.006707879249,0.006681230851,0.006654692348,0.006632376928,0.006610062439,0.006587747484,0.00656670006,0.006548674777,0.006530649494,0.006512623746,0.006496965885,0.006483125966,0.006469285581,0.006455445196,0.006445015315,0.006435255054,0.006425494794,0.006416159216,0.006410408765,0.006404658314,0.006398907863,0.006394665223,0.006392924115,0.006391183473,0.006389442831,0.006390288007,0.006392549723,0.006394810975,0.006397072691,0.006402922794,0.006409099791,0.006415277254,0.006422163453,0.006432140246,0.006442117039,0.006452093832,0.006463751197,0.006477407645,0.006491064094,0.006504720543,0.006520899944,0.006538026966,0.006555153988,0.006572281476,0.006592663471,0.006613056175,0.006633448415,0.006654649042,0.006678068079,0.006701487582,0.00672490662,0.006749821827,0.006776025519,0.006802229211,0.006828433368,0.006856692489,0.006885441486,0.006914190948,0.006943119224,0.006974177901,0.007005236577,0.007036295719,0.007068074774,0.007101204712,0.007134335116,0.007167465519,0.007201727014,0.007236687467,0.00727164885,0.007306610234,0.007342982572,0.007379533257,0.007416084409,0.007452844176,0.007490714081,0.00752858445,0.007566455286,0.007604766171,0.00764366379,0.00768256234,0.00772146089,0.007760864682,0.007800486404,0.007840108126,0.007879731245,0.007919756696,0.007959797047,0.007999836467,0.008039904758,0.008080063388,0.008120222017,0.008160380647,0.008200456388,0.008240451105,0.008280446753,0.00832044147,0.008360110223,0.008399685845,0.008439262398,0.008478806354,0.0085177375,0.008556669578,0.008595600724,0.008634266444,0.008672363125,0.008710460737,0.00874855835,0.008786074817,0.008823185228,0.00886029657,0.008897407912,0.008933569305,0.008969577029,0.009005584754,0.009041438811,0.009076259099,0.009111080319,0.009145901538,0.009180228226,0.009213810787,0.009247393347,0.009280976839,0.009313715622,0.009346039966,0.009378363378,0.009410687722,0.009441823699,0.009472884238,0.009503945708,0.009534742683,0.009564546868,0.009594351053,0.00962415617,0.009653369896,0.009681942873,0.009710516781,0.009739089757,0.009766766801,0.009794145823,0.009821522981,0.009848877788,0.009875105694,0.0099013336,0.009927560575,0.009953468107,0.009978593327,0.01000371855,0.01002884191,0.01005337946,0.01007745508,0.01010153163,0.01012560725,0.01014886051,0.01017194521,0.0101950299,0.01021802053,0.01024016924,0.01026231796,0.01028446667,0.01030628756,0.01032755431,0.0103488192,0.01037008595,0.01039083116,0.01041128486,0.01043173764,0.01045219135,0.01047196984,0.01049168315,0.01051139459,0.01053098217,0.01054999977,0.01056901738,0.01058803592,0.0106067583,0.01062512212,0.01064348593,0.01066184975,0.01067976654,0.01069751009,0.01071525458,0.01073299814,0.01075016148,0.01076732017,0.01078447793,0.01080149226,0.0108180996,0.01083470788,0.01085131522,0.0108676469,0.01088373549,0.01089982316,0.01091591083,0.0109316064,0.01094720606,0.01096280478,0.01097836997,0.01099350676,0.01100864355,0.0110237794,0.01103876717,0.01105346717,0.01106816716,0.01108286716,0.01109731384,0.01111160032,0.01112588681,0.0111401733,0.0111541152,0.01116801053,0.01118190587,0.01119574439,0.01120926905,0.01122279372,0.01123631839,0.01124969404,0.01126286667,0.01127603836,0.01128921099,0.01130215172,0.01131499,0.01132782735,0.01134066563,0.01135319751,0.01136571728,0.01137823798,0.01139068697,0.01140290499,0.01141512208,0.01142733917,0.0114394119,0.01145134028,0.01146326959,0.01147519797,0.01148691401,0.01149856765,0.01151022129,0.01152186375,0.01153325476,0.01154464483,0.01155603584,0.01156734768,0.0115784863,0.01158962492,0.01160076354,0.01161176246,0.01162266079,0.0116335582,0.01164445654,0.01165515743,0.01166582573,0.01167649217,0.01168713253,0.01169757824,0.01170802489,0.0117184706,0.01172883343,0.01173906773,0.01174930111,0.01175953541,0.01176963467,0.01177966502,0.01178969536,0.01179972477,0.01180957258,0.01181940641,0.01182924118,0.01183903683,0.01184868254,0.01185832825,0.01186797488,0.01187753398,0.01188699901,0.01189646311,0.01190592721,0.01191526093,0.01192455087,0.01193383988,0.01194312703,0.01195224747,0.01196136698,0.01197048742,0.0119795613,0.01198851783,0.01199747436,0.01200643182,0.0120153008,0.01202409994,0.01203289814,0.01204169728,0.01205036975,0.01205901615,0.01206766162,0.01207629312,0.01208479144,0.01209328789,0.01210178621,0.01211023051,0.01211858355,0.01212693751,0.01213529054,0.01214355417,0.0121517675,0.0121599799,0.01216819324,0.01217628177,0.0121843582,0.01219243463,0.01220048685,0.0122084301,0.01221637242,0.01222431473,0.01223219931,0.01224001125,0.01224782318,0.01225563511,0.01226335578,0.01227103919,0.01227872353,0.01228640787,0.01229396742,0.01230152603,0.01230908465,0.0123166116,0.01232404541,0.01233148016,0.01233891398,0.01234628446,0.01235359628,0.01236090809,0.0123682199,0.01237543579,0.01238262653,0.01238981821,0.0123970015,0.0124040721,0.0124111427,0.0124182133,0.01242524292,0.01243219431,0.01243914478,0.01244609524,0.01245297305,0.01245980337,0.01246663369,0.01247346401,0.01248018909,0.01248689927,0.01249360945,0.01250030193,0.01250689011,0.01251347922,0.01252006833,0.01252660621,0.01253307331,0.01253954042,0.01254600752,0.01255239081,0.01255873591,0.01256508008,0.01257142518,0.01257765386,0.01258387696,0.01259010006,0.01259630732,0.0126024643,0.01260862034,0.01261477638,0.01262090076,0.01262699161,0.01263308339,0.01263917517,0.01264521852,0.01265124697,0.01265727449,0.01266330015,0.0126692662,0.01267523132,0.01268119644,0.01268714294,0.01269304659,0.01269895118,0.01270485483,0.01271072496,0.01271656901,0.01272241306,0.0127282571,0.01273405179,0.0127398381,0.01274562348,0.01275140326,0.01275713276,0.01276286226,0.01276859175,0.01277430076,0.01277997531,0.01278564986,0.01279132441,0.01279696357,0.01280258596,0.01280820742,0.01281382889,0.01281940378,0.01282497402,0.01283054426,0.01283610519,0.01284162607,0.01284714695,0.01285266876,0.01285816729,0.0128636416,0.01286911592,0.01287459023,0.01288003102,0.01288546063,0.01289088931,0.01289631799,0.01290170476,0.01290709153,0.0129124783,0.01291785296,0.01292319968,0.01292854548,0.01293389127,0.0129392175,0.01294452604,0.01294983551,0.01295514405,0.01296042465,0.01296569873,0.01297097374,0.01297624502,0.01298148744,0.01298673078,0.0129919732,0.0129972063,0.01300242078,0.01300763525,0.01301285066,0.01301805023,0.01302324049,0.01302843168,0.01303362194,0.01303879451,0.01304396521,0.01304913592,0.01305430382,0.01305945963,0.0130646145,0.0130697703,0.01307492144,0.01308006607,0.01308521163,0.01309035718,0.01309549995,0.01310064085,0.01310578268,0.01311092358,0.01311606728,0.01312121004,0.01312635373,0.01313149929,0.01313665323,0.01314180624,0.01314696018,0.0131521225,0.01315729413,0.01316246577,0.0131676374,0.01317283139,0.01317803096,0.01318323053,0.01318843197,0.0131936688,0.01319890656,0.01320414431,0.01320937742,0.01321460027,0.01321982313,0.01322504692,0.01323026046,0.01323546749,0.01324067544,0.0132458834,0.01325107738,0.01325627044,0.01326146349,0.01326665469,0.01327183284,0.01327701192,0.01328219008,0.01328736357,0.01329252776,0.01329769287,0.01330285799,0.01330801379,0.01331316493,0.01331831608,0.01332346722,0.01332860813,0.01333374903,0.013338889,0.01334402803,0.01334916428,0.01335430052,0.01335943583,0.01336458325,0.01336974185,0.01337490138,0.0133800609,0.01338532101,0.01339061186,0.01339590363,0.01340119075,0.01340638008,0.01341157034,0.01341675967,0.01342184376,0.01342668571,0.01343152858,0.01343637146,0.01344133634,0.01344639156,0.01345144771,0.01345650386,0.01346153859,0.01346656866,0.01347159874,0.01347663533,0.01348171476,0.0134867942,0.01349187456,0.01349690836,0.01350186951,0.01350683067,0.01351179183,0.01351651642,0.01352111623,0.01352571603,0.01353031583,0.01353553776,0.01354080997,0.01354608126,0.01355134975,0.0135566052,0.01356185973,0.01356711425,0.01357195433,0.01357631944,0.01358068362,0.0135850478,0.01358947996,0.0135939382,0.01359839551,0.01360285282,0.01360725425,0.01361165568,0.01361605711,0.01362042502,0.01362470537,0.01362898573,0.01363326609,0.01363762841,0.01364205964,0.01364648994,0.01365092117,0.01365537196,0.01365982834,0.01366428379,0.01366873644,0.0136731565,0.01367757656,0.01368199661,0.0136863105,0.01369043067,0.01369455177,0.01369867194,0.01370264962,0.01370654162,0.01371043362,0.01371432561,0.01371799503,0.01372163929,0.01372528262,0.01372890919,0.01373244543,0.01373598166,0.01373951789,0.01374305319,0.01374658663,0.01375012007,0.0137536535,0.01375720464,0.01376076136,0.01376431901,0.01376787666,0.01377117634,0.01377447043,0.01377776451,0.01378092635,0.01378368121,0.01378643699,0.01378919184,0.01379186753,0.01379446872,0.0137970699,0.01379967108,0.01380211208,0.0138045093,0.01380690653,0.01380929165,0.01381147746,0.01381366421,0.01381585095,0.01381797716,0.0138199823,0.0138219865,0.01382399071,0.01382585429,0.01382762101,0.01382938866,0.01383115631,0.01383273676,0.01383428928,0.01383584179,0.01383737661,0.01383879874,0.01384022087,0.01384164393,0.01384296641,0.01384414453,0.01384532265,0.01384650078,0.01384739485,0.01384815294,0.01384891104,0.01384966914,0.01385003794,0.01385038625,0.01385073364,0.01385102607,0.01385111827,0.01385121047,0.01385130268,0.01385132689,0.01385128032,0.01385123283,0.01385118533,0.01385100838,0.01385078952,0.01385056973,0.01385034248,0.01384981815,0.01384929288,0.01384876855,0.01384815294,0.01384732313,0.01384649239,0.01384566259,0.01384472754,0.01384371333,0.01384269819,0.01384168305,0.01384061947,0.01383954566,0.01383847278,0.01383739803,0.01383631676,0.01383523457,0.0138341533,0.01383303851,0.01383186877,0.01383069903,0.01382952835,0.0138282897,0.01382701285,0.01382573694,0.0138244601,0.0138231013,0.01382173412,0.01382036693,0.01381899137,0.01381757762,0.01381616294,0.0138147492,0.01381333359,0.01381191704,0.01381049957,0.0138090821,0.01380766742,0.01380625367,0.01380483899,0.01380342524};
  std::vector<su2double> pv_test = {-0.4989964068,-0.4989952445,-0.4989940822,-0.4989928901,-0.498991698,-0.4989904463,-0.4989891946,-0.4989879131,-0.4989866018,-0.4989852011,-0.4989838302,-0.4989824295,-0.4989809692,-0.4989794493,-0.4989779294,-0.4989764392,-0.4989748001,-0.498973161,-0.4989715219,-0.4989698529,-0.4989680648,-0.4989663064,-0.4989645183,-0.4989626706,-0.4989607334,-0.4989587963,-0.4989568591,-0.4989548028,-0.4989526868,-0.4989506006,-0.4989484847,-0.4989462197,-0.4989439249,-0.4989416599,-0.4989393055,-0.498936832,-0.4989343584,-0.4989318848,-0.498929292,-0.4989266098,-0.4989239275,-0.4989212453,-0.4989183843,-0.4989154935,-0.4989125729,-0.4989096522,-0.498906523,-0.4989033639,-0.4989002049,-0.4988969862,-0.4988935888,-0.4988901913,-0.498886764,-0.4988832176,-0.4988795221,-0.4988758266,-0.4988721609,-0.498868227,-0.4988642335,-0.49886024,-0.4988562465,-0.4988519549,-0.4988476336,-0.4988433421,-0.4988389611,-0.4988342822,-0.498829633,-0.4988249838,-0.4988201559,-0.4988151491,-0.4988101125,-0.4988051057,-0.4987997711,-0.4987943769,-0.4987889826,-0.4987835586,-0.4987777174,-0.4987719059,-0.4987660646,-0.498760134,-0.4987538457,-0.4987475872,-0.4987412989,-0.4987347722,-0.4987280071,-0.4987212718,-0.4987145066,-0.4987073541,-0.4987001121,-0.4986928403,-0.4986855388,-0.4986777306,-0.4986699522,-0.4986621439,-0.4986541271,-0.4986457527,-0.4986373782,-0.4986290038,-0.4986202121,-0.4986112416,-0.4986022413,-0.498593241,-0.4985836446,-0.4985739887,-0.4985643327,-0.4985545576,-0.4985441864,-0.4985338449,-0.4985234737,-0.4985128045,-0.4985016882,-0.498490572,-0.4984794557,-0.4984677732,-0.4984558523,-0.4984439313,-0.4984320104,-0.498419255,-0.4984064698,-0.4983936846,-0.4983806908,-0.4983669817,-0.4983533025,-0.4983395934,-0.4983253777,-0.4983106852,-0.4982959926,-0.4982813001,-0.4982657731,-0.4982500374,-0.498234272,-0.4982184768,-0.4982015491,-0.4981846511,-0.4981677532,-0.4981504679,-0.4981323183,-0.4981141686,-0.4980960488,-0.4980770946,-0.4980576038,-0.4980381131,-0.4980186224,-0.49799788,-0.4979769289,-0.4979560077,-0.4979348183,-0.4979122877,-0.4978897572,-0.4978671968,-0.497843951,-0.4978196621,-0.4977953732,-0.4977710843,-0.4977454841,-0.4977192581,-0.4976930618,-0.4976668358,-0.497638613,-0.497610271,-0.497581929,-0.4975530505,-0.4975223541,-0.4974916577,-0.4974609315,-0.4974289536,-0.4973956048,-0.4973622859,-0.4973289371,-0.4972933829,-0.4972571135,-0.497220844,-0.4971844554,-0.4971449077,-0.4971053302,-0.4970657527,-0.4970250428,-0.4969817698,-0.4969384968,-0.4968951941,-0.4968495369,-0.4968020618,-0.4967545867,-0.4967071116,-0.4966556728,-0.4966034591,-0.4965512455,-0.4964984655,-0.4964408875,-0.4963833392,-0.4963257611,-0.4962658882,-0.4962022603,-0.4961386025,-0.4960749745,-0.4960068464,-0.4959363043,-0.4958657622,-0.4957952499,-0.4957175255,-0.4956391752,-0.4955608547,-0.4954808354,-0.4953936338,-0.495306462,-0.4952192903,-0.4951274693,-0.4950302839,-0.4949330986,-0.4948359132,-0.4947304726,-0.4946219623,-0.4945134819,-0.4944050014,-0.4942837358,-0.4941624999,-0.4940412641,-0.4939161241,-0.4937805533,-0.4936449826,-0.4935094118,-0.4933651388,-0.4932134748,-0.4930618405,-0.4929102063,-0.4927439392,-0.4925743341,-0.4924046993,-0.4922334254,-0.4920437634,-0.4918541014,-0.4916644692,-0.4914669394,-0.4912550449,-0.4910431504,-0.4908312261,-0.4906039834,-0.4903674424,-0.4901309311,-0.4898943901,-0.48963359,-0.489369899,-0.4891062081,-0.4888376296,-0.4885441363,-0.488250643,-0.4879571497,-0.48764956,-0.4873234928,-0.4869974554,-0.4866713881,-0.486320436,-0.4859589934,-0.4855975509,-0.4852361083,-0.484837383,-0.4844376445,-0.4840379357,-0.4836281538,-0.4831871688,-0.4827462137,-0.4823052287,-0.4818415642,-0.4813563824,-0.4808712304,-0.4803860486,-0.4798639119,-0.4793315828,-0.4787992835,-0.4782642424,-0.4776818752,-0.477099508,-0.4765171409,-0.4759176075,-0.4752823114,-0.4746470153,-0.4740117192,-0.4733433127,-0.4726522863,-0.4719612598,-0.4712702334,-0.4705280662,-0.4697779119,-0.4690277576,-0.4682690203,-0.4674552679,-0.4666415155,-0.4658277631,-0.4649860263,-0.4641031921,-0.4632202983,-0.4623374045,-0.4614032507,-0.4604444206,-0.4594855607,-0.4585266709,-0.4574948549,-0.456458807,-0.4554227293,-0.4543693662,-0.4532528818,-0.4521363974,-0.451019913,-0.4498633444,-0.448664248,-0.4474651217,-0.4462660253,-0.4450041056,-0.4437218308,-0.4424395561,-0.4411551952,-0.4397914112,-0.4384276867,-0.4370639026,-0.4356771111,-0.434235394,-0.4327936769,-0.4313519299,-0.4298681915,-0.4283522367,-0.4268362522,-0.4253202379,-0.4237439632,-0.4221558571,-0.4205677211,-0.4189718962,-0.4173115194,-0.4156511128,-0.4139907062,-0.412302345,-0.4105677009,-0.4088330269,-0.4070983827,-0.4053145945,-0.403504014,-0.4016933739,-0.3998827338,-0.3980031312,-0.39611727,-0.394231379,-0.3923320174,-0.3903740644,-0.3884160817,-0.3864580691,-0.3844692111,-0.3824436367,-0.3804180324,-0.3783924282,-0.3763225377,-0.3742360175,-0.3721494377,-0.3700628579,-0.3679231703,-0.3657832444,-0.3636433482,-0.3614914715,-0.3593067527,-0.357122004,-0.3549372852,-0.3527331352,-0.3505123258,-0.3482914865,-0.3460706174,-0.3438275754,-0.341579318,-0.3393309712,-0.3370811641,-0.3348138928,-0.332546562,-0.3302792311,-0.3280082047,-0.3257303536,-0.3234524131,-0.3211745024,-0.3188952506,-0.3166151941,-0.314335078,-0.3120549917,-0.3097803891,-0.3075064421,-0.3052324951,-0.3029609025,-0.3007019758,-0.2984429896,-0.2961840332,-0.2939354479,-0.2917008102,-0.2894661129,-0.2872314453,-0.2850203514,-0.2828194797,-0.2806185782,-0.2784176767,-0.2762584686,-0.2741006315,-0.2719427645,-0.2697972357,-0.2676911652,-0.2655850351,-0.263478905,-0.2614030838,-0.2593565285,-0.2573099732,-0.2552633882,-0.2532684207,-0.2512880266,-0.2493076622,-0.2473307848,-0.2454219311,-0.2435130477,-0.2416041642,-0.2397193313,-0.2378858626,-0.2360523641,-0.2342188507,-0.2324312031,-0.2306755781,-0.2289199084,-0.2271642536,-0.2254764885,-0.2237997949,-0.2221231014,-0.22045663,-0.2188588679,-0.217261076,-0.2156632841,-0.2140965611,-0.212576583,-0.2110565752,-0.2095365673,-0.2080673277,-0.2066230923,-0.2051788419,-0.2037346065,-0.2023592144,-0.2009881884,-0.1996171772,-0.1982609183,-0.1969602555,-0.1956595629,-0.1943588704,-0.1930903494,-0.1918566972,-0.1906230301,-0.189389348,-0.188203305,-0.1870331168,-0.1858629882,-0.1846940219,-0.1835837066,-0.1824733913,-0.1813630909,-0.1802691221,-0.1792150587,-0.1781609952,-0.1771069914,-0.1760824621,-0.1750810742,-0.1740797013,-0.1730783284,-0.1721177995,-0.1711655855,-0.1702134311,-0.1692658514,-0.168359533,-0.1674532294,-0.166546911,-0.1656564623,-0.1647929102,-0.1639293879,-0.1630658358,-0.1622276753,-0.1614037305,-0.1605797857,-0.159755826,-0.1589652002,-0.1581778079,-0.1573904455,-0.1566092223,-0.1558558494,-0.1551024765,-0.1543491185,-0.1536100507,-0.1528883874,-0.1521667391,-0.151445061,-0.1507447809,-0.1500527412,-0.1493606865,-0.1486686468,-0.148004055,-0.1473396868,-0.1466753334,-0.1460177451,-0.1453792155,-0.1447407007,-0.144102186,-0.143476516,-0.1428621709,-0.1422478557,-0.1416334957,-0.1410373151,-0.14044559,-0.1398538798,-0.1392636895,-0.1386931837,-0.1381226629,-0.1375521719,-0.1369884759,-0.1364378631,-0.1358872503,-0.1353366375,-0.1347974688,-0.134265542,-0.1337336451,-0.1332017183,-0.1326853037,-0.1321709603,-0.1316566169,-0.1311448067,-0.1306470186,-0.1301492453,-0.1296514422,-0.1291602552,-0.1286780685,-0.1281958818,-0.1277136952,-0.1272417158,-0.1267742515,-0.126306802,-0.1258393377,-0.1253852844,-0.1249317378,-0.1244781911,-0.1240277216,-0.1235873401,-0.1231469736,-0.1227065921,-0.1222724915,-0.1218445748,-0.1214166582,-0.1209887415,-0.1205699742,-0.1201538816,-0.1197378039,-0.1193222031,-0.1189173386,-0.118512474,-0.118107602,-0.1177060902,-0.1173118949,-0.1169177145,-0.1165235192,-0.1161352545,-0.1157512069,-0.1153671667,-0.1149831265,-0.1146073416,-0.1142329723,-0.1138586178,-0.1134853885,-0.113120243,-0.11275509,-0.112389937,-0.1120282635,-0.1116719171,-0.1113155857,-0.1109592319,-0.1106084734,-0.1102605388,-0.1099126041,-0.1095646694,-0.1092242524,-0.1088843793,-0.1085444912,-0.1082061827,-0.1078739986,-0.1075418219,-0.1072096452,-0.1068809703,-0.1065561771,-0.1062313989,-0.1059066057,-0.1055871025,-0.1052694023,-0.1049517021,-0.1046341136,-0.1043232307,-0.1040123627,-0.1037014797,-0.1033924669,-0.1030881479,-0.1027838215,-0.1024794951,-0.1021786854,-0.1018806845,-0.1015826911,-0.1012846902,-0.1009917185,-0.1006998047,-0.1004078984,-0.1001165509,-0.09983053058,-0.09954452515,-0.09925850481,-0.09897457063,-0.09869424254,-0.09841391444,-0.0981335938,-0.09785678238,-0.09758197516,-0.09730718285,-0.09703238308,-0.0967624262,-0.09649297595,-0.0962235257,-0.09595499188,-0.09569074959,-0.0954265222,-0.0951622799,-0.09490029514,-0.09464112669,-0.0943819508,-0.0941227749,-0.09386715293,-0.09361293912,-0.09335871786,-0.0931044966,-0.09285504371,-0.09260565788,-0.09235627204,-0.0921081081,-0.09186346829,-0.09161884338,-0.09137420356,-0.09113202244,-0.09089203924,-0.09065206349,-0.09041208029,-0.09017577022,-0.08994039148,-0.08970501274,-0.08946993202,-0.08923908323,-0.08900824189,-0.0887773931,-0.08854806423,-0.08832171559,-0.08809538186,-0.08786903322,-0.08764540404,-0.08742352575,-0.08720164746,-0.08697976917,-0.08676180989,-0.08654439449,-0.0863269791,-0.08611021191,-0.08589724451,-0.08568427712,-0.08547130227,-0.08526019007,-0.08505165577,-0.08484312892,-0.08463460207,-0.08442910016,-0.0842249766,-0.08402085304,-0.08381672949,-0.08361678571,-0.08341703564,-0.08321727067,-0.08301797509,-0.08282021433,-0.08262246102,-0.08242470771,-0.08222793043,-0.08203214407,-0.08183635026,-0.08164055645,-0.08144626021,-0.08125241846,-0.0810585767,-0.08086480945,-0.0806728825,-0.08048097044,-0.08028905094,-0.08009771258,-0.07990767807,-0.07971763611,-0.0795276016,-0.07933862507,-0.07915043086,-0.07896222174,-0.07877402008,-0.07858732343,-0.078400895,-0.07821445912,-0.07802823931,-0.07784352452,-0.07765881717,-0.07747410238,-0.07729002833,-0.07710696012,-0.07692388445,-0.07674081624,-0.07655878365,-0.07637729496,-0.07619579881,-0.07601430267,-0.07583419979,-0.07565420121,-0.07547420263,-0.07529447973,-0.07511588931,-0.0749373138,-0.07475872338,-0.07458075136,-0.07440348715,-0.07422621548,-0.07404895127,-0.07387258857,-0.07369655371,-0.07352050394,-0.07334447652,-0.07316955179,-0.07299462706,-0.07281970978,-0.07264506817,-0.07247115672,-0.07229724526,-0.07212332636,-0.0719498992,-0.07177686691,-0.07160384208,-0.0714308098,-0.07125839591,-0.07108612359,-0.07091385126,-0.07074163109,-0.07056996226,-0.07039829344,-0.07022663206,-0.07005512714,-0.06988392025,-0.06971270591,-0.06954149157,-0.06937044859,-0.06919951737,-0.0690285787,-0.06885764748,-0.06868679821,-0.06851596385,-0.06834512204,-0.06817425787,-0.0680033043,-0.06783235073,-0.06766139716,-0.06749028713,-0.06731899828,-0.06714770198,-0.06697639823,-0.06680467725,-0.0666327849,-0.06646090001,-0.06628900766,-0.0661162585,-0.06594350189,-0.06577073783,-0.06559768319,-0.06542373449,-0.06524978578,-0.06507584453,-0.06490110606,-0.06472563744,-0.06455016881,-0.06437470019,-0.06419772655,-0.06402035058,-0.0638429746,-0.06366544962,-0.06348575652,-0.06330604851,-0.06312634796,-0.0629466027,-0.06276677549,-0.06258694828,-0.06240711734,-0.06222718582,-0.06204719469,-0.06186719611,-0.06168719381,-0.06150695682,-0.06132668257,-0.06114641204,-0.06096608564,-0.06078545004,-0.06060481071,-0.06042416766,-0.0602433309,-0.06006222218,-0.05988111347,-0.05970000476,-0.05951850861,-0.05933684111,-0.05915516242,-0.05897348747,-0.05879111961,-0.05860871822,-0.05842632055,-0.0582436882,-0.05806025118,-0.05787681416,-0.05769337714,-0.05750894919,-0.05732352287,-0.05713807791,-0.05695263669,-0.05676297843,-0.05657202005,-0.05638105795,-0.056190148,-0.05600070581,-0.0558112599,-0.05562181771,-0.0554353334,-0.0552556254,-0.05507592112,-0.05489621311,-0.05471165478,-0.054523509,-0.05433534458,-0.0541471839,-0.05395832285,-0.05376933143,-0.05358034,-0.05339098349,-0.05319876969,-0.05300655961,-0.05281434953,-0.05262291059,-0.05243270844,-0.0522425063,-0.05205230415,-0.05186842382,-0.05168789625,-0.05150735378,-0.05132681131,-0.05112515017,-0.05092176422,-0.050718382,-0.05051473156,-0.05030998215,-0.05010523275,-0.04990048334,-0.04970792308,-0.04952939972,-0.04935087264,-0.04917234927,-0.04899038002,-0.04880714789,-0.04862391576,-0.04844068363,-0.0482574515,-0.04807421938,-0.04789098725,-0.04770831764,-0.04752713069,-0.04734594747,-0.04716476426,-0.04698016495,-0.04679271951,-0.04660527408,-0.04641782865,-0.0462284945,-0.04603870958,-0.04584892467,-0.04565911368,-0.04546903819,-0.0452789627,-0.04508889094,-0.0449016802,-0.04471965134,-0.04453762248,-0.04435559735,-0.04417728633,-0.04400119558,-0.04382510483,-0.04364901781,-0.04347889125,-0.0433094427,-0.04313999042,-0.04297096655,-0.04280406609,-0.04263716936,-0.04247027263,-0.04230320081,-0.04213590175,-0.04196860269,-0.04180130735,-0.04163333774,-0.04146508873,-0.04129683971,-0.04112859443,-0.04096789658,-0.0408073701,-0.04064684361,-0.04049032182,-0.0403460376,-0.04020175338,-0.04005747288,-0.03991561756,-0.03977603465,-0.03963645175,-0.03949687257,-0.03936218098,-0.03922881559,-0.03909545019,-0.03896246478,-0.03883579746,-0.03870911896,-0.03858244047,-0.0384577252,-0.03833704814,-0.03821637109,-0.03809569776,-0.03797947988,-0.03786626458,-0.03775304928,-0.03763983771,-0.03753250092,-0.03742606193,-0.03731962666,-0.03721381724,-0.0371119529,-0.03701008111,-0.03690820932,-0.0368094705,-0.03671528399,-0.03662109748,-0.03652691096,-0.03644145653,-0.03636015207,-0.03627884388,-0.03619753569,-0.03612823784,-0.03605959564,-0.03599095717,-0.03592411056,-0.0358637087,-0.0358032994,-0.03574289382,-0.03568495438,-0.03562960029,-0.03557424992,-0.03551889956,-0.03546793759,-0.03541837633,-0.03536881506,-0.03531952947,-0.03527950123,-0.03523947299,-0.03519944474,-0.03516229242,-0.03513188288,-0.03510147333,-0.03507106379,-0.03504404053,-0.03501958773,-0.03499513492,-0.03497068211,-0.03494761139,-0.03492480144,-0.03490199521,-0.03487925604,-0.03485707939,-0.03483489901,-0.03481272236,-0.03479159251,-0.03477218375,-0.03475277126,-0.0347333625,-0.03471639752,-0.03470074758,-0.03468510136,-0.03466945514,-0.03465725109,-0.03464535251,-0.03463345021,-0.03462199867,-0.03461246938,-0.03460294008,-0.03459341079,-0.03458437324,-0.03457590938,-0.03456744924,-0.03455898911,-0.03455107659,-0.03454336897,-0.03453566507,-0.03452795744
};
  std::vector<su2double> enth_test = {1190.130493,1191.211792,1192.293213,1193.374512,1194.481445,1195.664795,1196.848145,1198.031494,1199.270996,1200.565918,1201.86084,1203.155762,1204.542847,1205.959961,1207.377197,1208.795044,1210.346069,1211.897095,1213.448242,1215.036865,1216.734741,1218.432495,1220.130371,1221.909912,1223.768799,1225.627563,1227.48645,1229.479614,1231.515381,1233.55127,1235.588989,1237.81958,1240.050049,1242.280518,1244.567139,1247.012085,1249.457031,1251.901978,1254.468384,1257.150146,1259.832031,1262.513794,1265.395752,1268.3396,1271.283325,1274.231689,1277.466064,1280.700439,1283.934814,1287.255371,1290.812866,1294.370239,1297.927734,1301.671875,1305.5896,1309.507202,1313.424927,1317.65271,1321.973511,1326.294189,1330.624268,1335.397217,1340.170166,1344.943115,1349.854492,1355.136597,1360.418701,1365.700684,1371.283813,1377.140991,1382.998169,1388.855347,1395.217529,1401.726685,1408.23584,1414.76416,1422.014648,1429.265137,1436.515625,1443.999878,1452.09375,1460.1875,1468.281372,1476.901978,1485.958374,1495.014648,1504.071045,1514.029297,1524.188843,1534.348511,1544.619141,1556.046875,1567.474609,1578.902222,1590.852417,1603.740601,1616.628784,1629.516968,1643.463257,1658.036743,1672.610107,1687.183594,1703.505981,1720.0271,1736.548218,1753.44812,1772.222168,1790.996216,1809.770142,1829.678467,1851.040405,1872.402466,1893.764526,1917.234375,1941.571899,1965.909546,1990.24707,2017.937256,2045.70105,2073.464844,2102.208496,2133.913574,2165.618652,2197.323975,2231.37793,2267.61084,2303.84375,2340.076416,2380.405273,2421.830078,2463.254883,2505.030273,2552.395752,2599.760986,2647.126465,2696.724121,2750.870361,2805.016113,2859.162354,2917.934326,2979.798828,3041.66333,3103.527832,3173.007568,3243.630859,3314.253906,3386.259766,3466.78833,3547.316895,3627.845459,3712.947021,3804.637695,3896.328125,3988.018555,4088.226807,4192.445801,4296.665039,4400.883789,4518.405762,4636.62793,4754.850098,4876.501953,5010.305664,5144.108887,5277.912598,5420.17627,5571.23584,5722.29541,5873.35498,6038.871582,6208.943848,6379.015137,6549.724121,6740.632812,6931.543457,7122.452148,7320.19043,7533.807129,7747.425781,7961.04248,8188.702148,8426.917969,8665.132812,8903.350586,9163.833984,9428.53125,9693.225586,9961.068359,10254.07715,10547.08887,10840.09766,11144.57031,11467.64453,11790.72168,12113.79492,12457.50879,12812.27539,13167.03711,13521.80371,13907.10742,14295.01855,14682.92578,15077.42578,15499.72266,15922.02539,16344.32227,16782.96484,17240.6543,17698.3418,18156.03516,18640.15625,19133.9668,19627.77148,20121.58203,20652.01367,21182.37891,21712.73828,22253.08984,22820.15039,23387.2168,23954.2793,24541.17578,25144.82812,25748.4707,26352.12109,26985.20703,27625.0957,28264.98047,28907.81836,29583.43359,30259.05664,30934.67188,31622.68555,32333.4375,33044.1875,33754.94531,34488.32812,35235.42578,35982.51172,36729.60938,37513.96875,38302.80859,39091.64062,39887.92969,40722.4375,41556.95312,42391.46484,43248.08594,44133.66016,45019.22266,45904.79297,46831.13281,47774.68359,48718.22266,49661.77344,50669.91797,51679.83203,52689.73828,53718.125,54803.86328,55889.60156,56975.35547,58105.08594,59276.42188,60447.78516,61619.14844,62864.55859,64130.35547,65396.17969,66667.4375,68033.9375,69400.40625,70766.90625,72166.50781,73635.11719,75103.75781,76572.40625,78100.42969,79668.96875,81237.53906,82806.10938,84475.95312,86161.65625,87847.39062,89549.22656,91354.66406,93160.0625,94965.50781,96814.92188,98728.99219,100643.1094,102557.2188,104529.5625,106529.9297,108530.3281,110530.7344,112585.0,114642.3594,116699.7578,118760.5,120833.4141,122906.3672,124979.3281,127037.6953,129080.5312,131123.4219,133166.3125,135190.5,137208.5781,139226.7031,141243.7812,143220.2188,145196.6094,147173.0469,149127.8125,151030.875,152933.9844,154837.0781,156677.7031,158470.3125,160262.9688,162055.625,163721.75,165362.9844,167004.2656,168624.4531,170066.7656,171509.1094,172951.4531,174316.7344,175554.1406,176791.5938,178029.0312,179117.5781,180124.5938,181131.625,182138.6719,182877.7656,183592.3906,184307.0312,184966.2344,185383.5938,185800.9688,186218.3438,186526.5156,186704.7344,186882.9531,187061.1875,187065.0781,187003.4375,186941.7812,186880.1406,186612.6406,186344.4844,186076.3438,185755.375,185289.4688,184823.5625,184357.6562,183789.8438,183134.2656,182478.6875,181823.0938,181022.6094,180187.5781,179352.5156,178504.5625,177503.0156,176501.4531,175499.8906,174446.0625,173294.2031,172142.3125,170990.4219,169759.9844,168480.9844,167201.9531,165922.9219,164561.2812,163189.1562,161817.0469,160433.4375,158988.5938,157543.7344,156098.875,154630.6562,153131.2656,151631.8438,150132.4375,148608.8281,147074.7969,145540.75,144006.6875,142459.4375,140911.7344,139364.0156,137817.8438,136276.5469,134735.2188,133193.9062,131664.8125,130147.5859,128630.3203,127113.0547,125625.6562,124146.7031,122667.7422,121191.1641,119760.7969,118330.3984,116900.0,115487.0469,114111.375,112735.6719,111359.9688,110017.8438,108699.1562,107380.4453,106061.7344,104791.1875,103528.5,102265.8047,101009.9062,99799.71875,98589.50781,97379.29688,96187.9375,95024.95312,93861.9375,92698.92188,91565.86719,90447.55469,89329.24219,88210.92969,87129.10156,86049.59375,84970.07812,83896.64844,82846.125,81795.57812,80745.03125,79705.35938,78677.49219,77649.60156,76621.70312,75606.75781,74596.11719,73585.52344,72575.14062,71577.09375,70579.03906,69580.98438,68585.45312,67596.07031,66606.69531,65617.35938,64631.75,63649.08984,62666.42969,61683.77344,60707.71094,59732.99609,58758.32031,57784.32422,56816.76953,55849.21484,54881.66016,53916.80859,52956.54297,51996.31641,51036.05078,50088.27344,49147.48828,48206.70312,47265.91797,46355.72266,45448.50391,44541.32812,43639.66016,42763.04297,41886.42188,41009.80469,40145.54297,39296.29688,38447.08203,37597.83203,36763.82812,35935.70703,35107.58594,34279.46094,33469.73828,32660.16406,31850.625,31045.60742,30253.41797,29461.23047,28669.04102,27885.54883,27109.70117,26333.88867,25558.04102,24794.54492,24034.0918,23273.63867,22514.24023,21768.32422,21022.4082,20276.52539,19535.32422,18803.16992,18071.01562,17338.86328,16614.70898,15895.61523,15176.55176,14457.45801,13749.33203,13042.66309,12335.99512,11631.1377,10936.32031,10241.53223,9546.713867,8856.688477,8173.19873,7489.708984,6806.219238,6130.251953,5457.61377,4785.004883,4112.366699,3449.76123,2787.53833,2125.315674,1465.430298,813.2212524,161.0404205,-491.1686096,-1138.522217,-1781.088623,-2423.655029,-3066.221436,-3701.607422,-4334.893066,-4968.151855,-5601.060547,-6225.748535,-6850.436523,-7475.124512,-8097.250977,-8713.78125,-9330.28418,-9946.813477,-10558.73828,-11167.38184,-11776.02637,-12384.66992,-12986.79785,-13587.81348,-14188.80273,-14788.90039,-15382.5332,-15976.16602,-16569.79883,-17160.61328,-17747.10156,-18333.56445,-18920.05469,-19501.94727,-20081.52344,-20661.09766,-21240.67383,-21813.99805,-22386.86328,-22959.75,-23531.31445,-24097.74023,-24664.16406,-25230.58789,-25794.04688,-26354.22656,-26914.38281,-27474.56445,-28030.25391,-28584.4082,-29138.5625,-29692.62695,-30240.97266,-30789.29492,-31337.64062,-31884.39258,-32427.14844,-32969.90625,-33512.66016,-34052.43359,-34589.81641,-35127.17578,-35664.5625,-36197.69141,-36729.92578,-37262.16016,-37793.92188,-38321.22656,-38848.50781,-39375.81641,-39901.39844,-40424.0,-40946.60156,-41469.20312,-41988.96094,-42507.08594,-43025.19141,-43543.31641,-44057.59766,-44571.47656,-45085.35938,-45598.53516,-46108.40625,-46618.25781,-47128.13281,-47636.32422,-48142.42578,-48648.52734,-49154.62891,-49658.20312,-50160.75781,-50663.33203,-51165.91016,-51665.24219,-52164.53516,-52663.82422,-53162.32422,-53658.54688,-54154.74609,-54650.96484,-55145.69922,-55639.09375,-56132.49219,-56625.89062,-57117.24609,-57608.05859,-58098.89062,-58589.57031,-59078.10547,-59566.63672,-60055.17188,-60543.01953,-61029.51953,-61516.0,-62002.50391,-62487.93359,-62972.66797,-63457.40625,-63942.14062,-64425.56641,-64908.78906,-65392.03125,-65875.09375,-66357.11719,-66839.13281,-67321.15625,-67802.77344,-68283.84375,-68764.89062,-69245.96094,-69726.57031,-70206.96875,-70687.36719,-71167.76562,-71647.79688,-72127.78125,-72607.79688,-73087.82812,-73567.95312,-74048.07031,-74528.1875,-75008.65625,-75489.44531,-75970.26562,-76451.07812,-76932.84375,-77414.90625,-77896.96875,-78379.09375,-78862.97656,-79346.83594,-79830.71094,-80315.34375,-80801.64844,-81287.95312,-81774.25,-82262.32812,-82751.66406,-83241.02344,-83730.38281,-84222.90625,-84715.99219,-85209.07812,-85702.6875,-86200.20312,-86697.70312,-87195.21875,-87694.74219,-88197.42969,-88700.11719,-89202.80469,-89709.42188,-90218.04688,-90726.69531,-91235.34375,-91750.29688,-92265.73438,-92781.17188,-93298.13281,-93821.23438,-94344.3125,-94867.41406,-95394.55469,-95926.25,-96457.94531,-96989.64062,-97528.42188,-98069.67188,-98610.94531,-99152.32812,-99704.22656,-100256.1172,-100808.0078,-101363.1875,-101926.7812,-102490.3906,-103054.0078,-103624.7188,-104201.2266,-104777.7266,-105354.2344,-105942.3281,-106532.9375,-107123.5625,-107715.5938,-108321.6719,-108927.7422,-109533.8125,-110145.9609,-110768.8281,-111391.7266,-112014.625,-112649.0703,-113290.2812,-113931.4844,-114572.6875,-115231.7969,-115892.8359,-116553.9062,-117218.6641,-117901.2656,-118583.8672,-119266.4609,-119959.3359,-120665.1953,-121371.0781,-122076.9609,-122800.75,-123531.7969,-124262.8438,-124993.8906,-125751.5859,-126509.7422,-127267.9375,-128033.4922,-128820.9453,-129608.3906,-130395.8359,-131199.7344,-132018.6562,-132837.6094,-133656.5625,-134502.375,-135355.2188,-136208.0625,-137063.1875,-137952.4531,-138841.75,-139731.0469,-140633.2812,-141561.5156,-142489.7344,-143417.9688,-144371.1406,-145340.75,-146310.4062,-147280.0469,-148288.1562,-149301.875,-150315.5781,-151335.9844,-152396.4688,-153457.0156,-154517.5469,-155598.6094,-156708.8594,-157819.0938,-158929.3438,-160075.625,-161238.5781,-162401.5781,-163564.5781,-164781.0625,-166000.1875,-167219.3125,-168451.8594,-169731.1094,-171010.375,-172289.625,-173601.6875,-174947.3438,-176293.1094,-177638.875,-179046.7812,-180473.9531,-181901.1094,-183330.625,-184827.625,-186324.6094,-187821.5938,-189326.3125,-190848.7188,-192371.125,-193893.5312,-195476.1094,-197103.1875,-198730.4219,-200357.6406,-202049.9375,-203754.25,-205458.5625,-207172.8438,-208964.4219,-210756.0,-212547.5781,-214366.8594,-216230.5156,-218094.1719,-219957.8281,-221850.1719,-223757.4844,-225664.9688,-227572.4375,-229634.25,-231708.6406,-233783.0469,-235876.3906,-238048.1406,-240219.875,-242391.6094,-244556.0156,-246711.9844,-248867.9531,-251023.9219,-253259.2656,-255523.5,-257787.75,-260052.4531,-262408.5938,-264764.7188,-267120.8438,-269500.5,-271942.0,-274383.5312,-276825.0312,-279330.9062,-281890.4062,-284449.9062,-287009.375,-289656.5312,-292323.8125,-294991.0625,-297666.875,-300433.9375,-303201.0,-305968.0625,-308756.9688,-311585.4062,-314413.8438,-317242.2812,-320115.1562,-323014.5938,-325914.0312,-328813.4375,-331773.625,-334741.125,-337708.6562,-340690.125,-343741.6562,-346793.1875,-349844.7188,-352937.4375,-356083.4375,-359229.4062,-362375.375,-365589.375,-368831.5938,-372073.8438,-375316.0625,-378618.625,-381922.875,-385227.1562,-388534.875,-391853.0625,-395171.25,-398489.4375,-401846.5625,-405240.0312,-408633.5,-412026.9688,-415476.7188,-418941.6875,-422406.6875,-425875.2812,-429403.3125,-432931.6562,-436459.9688,-440009.125,-443601.0625,-447193.0,-450784.9375,-454416.3125,-458074.2812,-461732.25,-465390.2188,-469114.1562,-472848.125,-476582.125,-480327.6875,-484145.4062,-487963.4688,-491781.5,-495628.8438,-499518.6875,-503408.5312,-507298.375,-511204.4062,-515118.0938,-519031.8125,-522945.5,-526871.5,-530798.125,-534724.75,-538660.4375,-542628.125,-546596.125,-550564.125,-554559.5625,-558583.625,-562607.6875,-566631.8125,-570694.8125,-574770.1875,-578845.625,-582921.0,-586996.375,-591071.75,-595147.125,-599214.125,-603262.6875,-607311.25,-611359.8125,-615406.1875,-619450.875,-623495.625,-627540.375,-631592.125,-635645.3125,-639698.4375,-643751.625,-647805.25,-651858.875,-655912.5,-659964.4375,-664014.625,-668064.75,-672114.875,-676143.9375,-680161.625,-684179.3125,-688196.9375,-692164.8125,-696128.25,-700091.75,-704048.4375,-707976.1875,-711903.9375,-715831.625,-719745.4375,-723643.5,-727541.5625,-731439.625,-735320.5,-739195.0,-743069.4375,-746943.9375};

  //CLookUpTable LUT = CLookUpTable("/home/ecbunschoten/RACE/Table_vs_MLP/LUT/Comparison_Case/LUT_400_03_015.drg", input_varnames[0], input_varnames[1]);
  su2double dTdpv, dTdenth, dTdmixfrac;
  for (auto i=0u; i<5000; i++){
    // pv = pv_test[i];
    // enth = enth_test[i];
    // mixfrac = mixfrac_test[i];
    GetManifoldDerivatives(pv, enth, mixfrac, &dTdpv, &dTdenth, &dTdmixfrac, MLP_output_refs, lookup_MLP, iomap);
    std::cout << std::setprecision(10) << pv << ", " << std::setprecision(10) << Temperature << ", " << std::setprecision(10) << dTdpv << ", " << std::setprecision(10) << dTdenth << ", " << std::setprecision(10) << dTdmixfrac << std::endl;
    pv += 1e-4;
  }
  

  // AD::StartRecording();
  // AD::RegisterInput(pv);
  // AD::SetIndex(idx_pv, pv);
  // AD::RegisterInput(enth);
  // AD::SetIndex(idx_enth, enth);
  // AD::RegisterInput(mixfrac);
  // AD::SetIndex(idx_mixfrac, mixfrac);

  // MLP_inputs[0] = pv;
  // MLP_inputs[1] =	enth;
  // MLP_inputs[2] = mixfrac;

  // lookup_MLP.PredictANN(&iomap, MLP_inputs, MLP_output_refs);
  // //LUT.LookUp_XYZ(output_varnames, MLP_output_refs, pv, enth, mixfrac);
  // su2double T_output = Temperature;
  // AD::RegisterOutput(T_output);
  // AD::StopRecording();
  // SU2_TYPE::SetDerivative(T_output, 1.0);
  // AD::ComputeAdjoint();

  // su2double dTdpv= AD::GetDerivative(idx_pv);
  // su2double dTdenth= AD::GetDerivative(idx_enth);
  // su2double dTdmixfrac= AD::GetDerivative(idx_mixfrac);
  // std::cout << "Adjoint gradients: " << dTdpv << ", " << dTdenth << ", " << dTdmixfrac << std::endl;

  // su2double sol_center = Temperature;
  // MLP_inputs[2] = mixfrac;
  // MLP_inputs[0] = pv + delta;
  // lookup_MLP.PredictANN(&iomap, MLP_inputs, MLP_output_refs);
  // //LUT.LookUp_XYZ(output_varnames, MLP_output_refs, pv+delta, enth, mixfrac);
  // su2double sol_pv_plus = Temperature;
  // MLP_inputs[0] = pv;
  // MLP_inputs[1] = enth + 10*delta; 
  // lookup_MLP.PredictANN(&iomap, MLP_inputs, MLP_output_refs);
  // //LUT.LookUp_XYZ(output_varnames, MLP_output_refs, pv, enth+10*delta, mixfrac);
  // su2double sol_enth_plus = Temperature;
  // MLP_inputs[1] = enth;
  // MLP_inputs[2] = mixfrac + delta; 
  // lookup_MLP.PredictANN(&iomap, MLP_inputs, MLP_output_refs);
  // //LUT.LookUp_XYZ(output_varnames, MLP_output_refs, pv, enth, mixfrac+delta);
  // su2double sol_mixfrac_plus = Temperature;
  // MLP_inputs[2] = mixfrac;
  // MLP_inputs[0] = pv - delta;
  // lookup_MLP.PredictANN(&iomap, MLP_inputs, MLP_output_refs);
  // //LUT.LookUp_XYZ(output_varnames, MLP_output_refs, pv-delta, enth, mixfrac);
  // su2double sol_pv_minus = Temperature;
  // MLP_inputs[0] = pv;
  // MLP_inputs[1] = enth - 10*delta; 
  // lookup_MLP.PredictANN(&iomap, MLP_inputs, MLP_output_refs);
  // //LUT.LookUp_XYZ(output_varnames, MLP_output_refs, pv, enth-10*delta, mixfrac);
  // su2double sol_enth_minus = Temperature;
  // MLP_inputs[1] = enth;
  // MLP_inputs[2] = mixfrac - delta; 
  // lookup_MLP.PredictANN(&iomap, MLP_inputs, MLP_output_refs);
  // //LUT.LookUp_XYZ(output_varnames, MLP_output_refs, pv, enth, mixfrac-delta);
  // su2double sol_mixfrac_minus = Temperature;

  // su2double dTdpv_d = (sol_pv_plus - sol_pv_minus)/(2*delta);
  // su2double dTdenth_d = (sol_enth_plus - sol_enth_minus)/(20*delta);
  // su2double dTdmixfrac_d = (sol_mixfrac_plus - sol_mixfrac_minus)/(2*delta);

  // std::cout << "Finite-differences gradients: " << dTdpv_d << ", " << dTdenth_d << ", " << dTdmixfrac_d << std::endl;
}